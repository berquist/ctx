## ---------------------------------------------------------------------
##
## Copyright (C) 2017 by the ctx authors
##
## This file is part of ctx.
##
## ctx is free software: you can redistribute it and/or modify
## it under the terms of the GNU Lesser General Public License as published
## by the Free Software Foundation, either version 3 of the License, or
## (at your option) any later version.
##
## ctx is distributed in the hope that it will be useful,
## but WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
## GNU Lesser General Public License for more details.
##
## You should have received a copy of the GNU Lesser General Public License
## along with ctx. If not, see <http://www.gnu.org/licenses/>.
##
## ---------------------------------------------------------------------

## This file is provided for compatibility with Q-Chem's libctx.
## It is of no other use inside this library.

cmake_minimum_required(VERSION 3.0.0)

# Find the compiled stuff
find_library(CTX_LIBRARY
	ctx
	PATHS ${LIBCTX_DIR}/build/src/ctx ${CMAKE_SOURCE_DIR}/../libctx/build/src/ctx
)
if(${CTX_LIBRARY} MATCHES "-NOTFOUND")
	message(FATAL_ERROR "Could not find ctx library at the expected place: ${LIBCTX_DIR}")
else()
	message(STATUS "Found ctx at ${CTX_LIBRARY}")
endif()

find_library(KRIMS_LIBRARY
	krims
	HINTS "${CTX_LIBRARY}/../../external/krims/src/krims"
	PATHS ${LIBCTX_DIR}/build/external/krims/src/krims ${CMAKE_SOURCE_DIR}/../krims/build/src/krims
)
if(${KRIMS_LIBRARY} MATCHES "-NOTFOUND")
	message(FATAL_ERROR "Could not find krims library at the expected place: ${LIBCTX_DIR}/build/external/krims")
else()
	message(STATUS "Found krims at ${KRIMS_LIBRARY}")
endif()

# This thing needs to be called ctx
add_library(ctx INTERFACE IMPORTED GLOBAL)
set_target_properties(ctx
       PROPERTIES
       INTERFACE_LINK_LIBRARIES "${CTX_LIBRARY};${KRIMS_LIBRARY}"
       INTERFACE_INCLUDE_DIRECTORIES "${LIBCTX_DIR}/src;${LIBCTX_DIR}/external/krims/src"
)

# Even though we give this in the ctx target properties, this needs to be global, too.
include_directories("${LIBCTX_DIR}/src;${LIBCTX_DIR}/external/krims/src")

set(LIBCTX_LIBS ctx)
